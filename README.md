# Project 7 - WordPress Pentesting

> Objective: Discover and demonstrate proofs-of-concepts for at least three and (up to five) exploits affecting an older version of WordPress.

## Penetration Testing Report:

1. Username Enumeration by HTTP GET request
  - [ ] Summary: 
    - Vulnerability types: User Enumeration
    - Tested in version: 4.2
    - Fixed in version: N/A
    - [Blog Post Documenting Vulnerability](https://perishablepress.com/stop-user-enumeration-wordpress/)
  - [ ] GIF Walkthrough:
    
    ![Walkthrough](./gif/userenum.gif)
    
  - [ ] Steps to recreate:
    We try to access all the users in the database using a simple http get request by changing the values of the "author" parameter
    1. Enter ```http://wpdistillery.com?author=<author id>``` in the URL field and insert a number, which will be treated like an id.
      I used 1 as the first test param because usually 1 is assigned to the admin ```http://wpdistillery.com?author=1```
    2. We will be redirected to ```http://wpdistillery.vm/author/<user id>/ ```
      In my test case, I was redirected to ```http://wpdistillery.vm/author/admin/``` hence proving that we can access any user by brute forcing the author parameter. We can do this with burp or with a simple python script.

2. Unauthenticated Stored Cross-Site Scripting (XSS)
  - [ ] Summary:
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.1
    - [CVE 2015-3440](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3440)
    - [Exploit Database 36844](https://www.exploit-db.com/exploits/36844/)

  - [ ] GIF Walkthrough:
    
    ![Walkthrough](./gif/xss.gif)
    
  - [ ] Steps to recreate:
    - Find a post on the target WordPress site and make a benign comment. Something like "nice article" works.
    - Since the comment was not spam, the admin will naturally approve it.
    - Once the admin approves this comment, all subsequent comments won't be needed to be approved by the admin.
    - Now, open the file: [xss.js](./code/xss.js)
    - Copy the contents of this file and post this as a comment on any post on the WP site.
    - Refresh the page and hover over the comment you just made. 
    - You'll be able to see an alert which proves that there is a XSS vulnerability present.
  - [ ] Affected source code:
    - [wp-db.php](https://core.trac.wordpress.org/browser/tags/4.2/src/wp-includes/wp-db.php)
    
3. Directory Traversal
  - [ ] Summary: 
    - Vulnerability types: Information Overexposure
    - Tested in version: 4.2
    - [CVE 548](https://cwe.mitre.org/data/definitions/548.html)
    - Fixed in version: N/A
  - [ ] GIF Walkthrough:
  
    ![image Walkthrough](./gif/directory.gif)
    
  - [ ] Steps to recreate:
    - Navigate to [/wp-admin/js](http://wpdistillery/wp-admin/js) or [/wp-admin/css](http://wpdistillery.vm/wp-admin/css/)
    - You can view all the files on the server even though you are not an authenticated admin.
    - Hence, any person can view the sensitive files (like the login code) and leverage that to potentially find a backdoor into the system.
  - [ ] Affected source code:
    N/A

4. User Enumeration with Login Error Messages
  - [ ] Summary: 
    - Vulnerability types: User Enumeration
    - Tested in version: 4.2
    - Fixed in version: N/A
    - [CVE 2009-2335](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2335)
  - [ ] GIF Walkthrough:
  
    ![Image walkthrough](./gif/userenum_login.gif)
    
  - [ ] Steps to recreate:
    1. Type a known username in the username field.
    2. Guess a possible password and try to login.
    3. You will see an error message which confirms that this user exists.
    4. Repeat the steps for an unknown user (who doesn't exist) and you'll see a different error message which mentions "invalid username".
    
## Resources:

- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [ezgif](http://www.ezgif.com/).

## Notes:

The exercise was performed on a macbook pro running on macOs Catalina. I couldn't get Licecap to work so I had to record my walkthroughs using Quicktime. I converted them to a gif format using the website ezgif.com with a low frame rate of 7 fps.

## Inital port scanning using Nmap & WP scanning using WPScan

### WPScan Report:

<img width="889" alt="Screenshot 2020-03-21 at 6 36 57 PM" src="https://user-images.githubusercontent.com/29928261/77238307-5cdd3c00-6ba5-11ea-9df6-a98cf3d9916b.png">

### NMap Report:

<img width="350" alt="Screenshot 2020-03-21 at 6 51 54 PM" src="https://user-images.githubusercontent.com/29928261/77238361-a463c800-6ba5-11ea-9112-07ea49d1f514.png">
