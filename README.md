# Project 7 - WordPress Pentesting

> Objective: Discover and demonstrate proofs-of-concepts for at least three and (up to five) exploits affecting an older version of WordPress.

## Penetration Testing Report:

1. Username Enumeration by HTTP GET request
  - [ ] Summary: 
    - Vulnerability types: User Enumeration
    - Tested in version: 4.2
    - Fixed in version: N/A
    - [Blog Post Documenting Vulnerability](https://perishablepress.com/stop-user-enumeration-wordpress/)
  - [ ] GIF Walkthrough:
    
    ![Walkthrough](./gif/userenum.gif)
  - [ ] Steps to recreate:
    We try to access all the users in the database using a simple http get request by changing the values of the "author" parameter
    1. Enter ```http://wpdistillery.com?author=<author id>``` in the URL field and insert a number, which will be treated like an id.
      I used 1 as the first test param because usually 1 is assigned to the admin ```http://wpdistillery.com?author=1```
    2. We will be redirected to ```http://wpdistillery.vm/author/<user id>/ ```
      In my test case, I was redirected to ```http://wpdistillery.vm/author/admin/``` hence proving that we can access any user by brute forcing the author parameter. We can do this with burp or with a simple python script.

2. Unauthenticated Stored Cross-Site Scripting (XSS)
  - [ ] Summary:
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.1
    - [CVE 2015-3440](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3440)
    - [Exploit Database 36844](https://www.exploit-db.com/exploits/36844/)

  - [ ] GIF Walkthrough:
    
    ![Walkthrough](./gif/xss.gif)
  - [ ] Steps to recreate:
    - Find a post on the target WordPress site and make a benign comment. Something like "nice article" works.
    - Since the comment was not spam, the admin will naturally approve it.
    - Once the admin approves this comment, all subsequent comments won't be needed to be approved by the admin.
    - Now, open the file: [xss.js](./code/xss.js)
    - Copy the contents of this file and post this as a comment on any post on the WP site.
    - Refresh the page and hover over the comment you just made. 
    - You'll be able to see an alert which proves that there is a XSS vulnerability present.
  - [ ] Affected source code:
    - [wp-db.php](https://core.trac.wordpress.org/browser/tags/4.2/src/wp-includes/wp-db.php)
